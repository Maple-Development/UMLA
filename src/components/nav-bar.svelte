<script>
  import {
    Tooltip,
    Button,
    Dropdown,
    DropdownItem,
    Chevron,
    Checkbox,
    ToolbarButton,
    MenuButton,
    DropdownDivider,
    Avatar,
  } from 'flowbite-svelte';
  let type = 'dark';
  import { onMount } from 'svelte';
  onMount(() => {
    let hovered = false;

    const onHover = (e) => {
      if (e.target.tagName !== 'A') return;
      console.log('real');

      const rect = e.target.getBoundingClientRect();

      document.getElementById('nav-move').style.width = rect.width - -45 + 'px';
      document.getElementById('nav-move').style.height = rect.height + 6 + 'px';

      requestAnimationFrame(() => {
        document.getElementById('nav-move').style.display = 'block';
        document.getElementById('nav-move').style.opacity = '1';
      });

      if (!hovered) {
        document.getElementById('nav-move').style.transition = `0`;
        document.getElementById('nav-move').style.opacity = '0';
        document.getElementById('nav-move').style.transition = `0.2s`;
      }

      document.getElementById('nav-move').style.left = `${rect.x - 45 + 5}px`;

      hovered = true;
    };

    const noHover = (e) => {
      if (e.target.tagName !== 'A') return;

      const rect = e.target.getBoundingClientRect();

      if (e.clientY >= rect.bottom || e.clientY <= rect.top) {
        hovered = false;
        document.getElementById('nav-move').style.opacity = '0';
        setTimeout(function () {
          document.getElementById('nav-move').style.display = 'none';
        }, 200);
      }
    };

    const navBtns = document.querySelectorAll('.nav-btn');
    navBtns.forEach((btn) => {
      btn.onmouseover = onHover;
      btn.onmouseleave = noHover;
    });
  });
</script>

<div class="nav-bar">
  <!-- svelte-ignore a11y-click-events-have-key-events -->
  <a href="/upload">
    <div class="upload_icon">
      <svg
        viewBox="0 0 27 29"
        fill="none"
        xmlns="http://www.w3.org/2000/svg%22%3E"
      >
        <rect width="27" height="29" fill="#1E1E1E" />
        <g id="MacBook Pro 14&#34; - 1" clip-path="url(#clip0_0_1)">
          <rect
            width="1512"
            height="982"
            transform="translate(-30 -19)"
            fill="black"
          />
          <path
            id="Vector"
            d="M15.1875 6.18971V19.9371C15.1875 20.9396 14.4334 21.7496 13.5 21.7496C12.5666 21.7496 11.8125 20.9396 11.8125 19.9371V6.18971L7.9418 10.3473C7.28262 11.0554 6.21211 11.0554 5.55293 10.3473C4.89375 9.63929 4.89375 8.48943 5.55293 7.78139L12.3029 0.531032C12.9621 -0.177011 14.0326 -0.177011 14.6918 0.531032L21.4418 7.78139C22.101 8.48943 22.101 9.63929 21.4418 10.3473C20.7826 11.0554 19.7121 11.0554 19.0529 10.3473L15.1875 6.18971ZM3.375 19.9371H10.125C10.125 21.9366 11.6385 23.5622 13.5 23.5622C15.3615 23.5622 16.875 21.9366 16.875 19.9371H23.625C25.4865 19.9371 27 21.5627 27 23.5622V25.3748C27 27.3743 25.4865 29 23.625 29H3.375C1.51348 29 0 27.3743 0 25.3748V23.5622C0 21.5627 1.51348 19.9371 3.375 19.9371ZM22.7812 25.828C23.1169 25.828 23.4388 25.6847 23.6762 25.4298C23.9135 25.1749 24.0469 24.8291 24.0469 24.4685C24.0469 24.108 23.9135 23.7622 23.6762 23.5073C23.4388 23.2523 23.1169 23.1091 22.7812 23.1091C22.4456 23.1091 22.1237 23.2523 21.8863 23.5073C21.649 23.7622 21.5156 24.108 21.5156 24.4685C21.5156 24.8291 21.649 25.1749 21.8863 25.4298C22.1237 25.6847 22.4456 25.828 22.7812 25.828Z"
            fill="#81F0FF"
          />
        </g>
        <defs>
          <clipPath id="clip0_0_1">
            <rect
              width="1512"
              height="982"
              fill="white"
              transform="translate(-30 -19)"
            />
          </clipPath>
        </defs>
      </svg>
    </div>
  </a>
  <div class="library">
    <div class="library_icon">
      <svg viewBox="0 0 27 29" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          id="Vector"
          d="M24.3 0H8.1C6.615 0 5.4 1.305 5.4 2.9V20.3C5.4 21.895 6.615 23.2 8.1 23.2H24.3C25.785 23.2 27 21.895 27 20.3V2.9C27 1.305 25.785 0 24.3 0ZM20.25 7.25H17.55V15.0365C17.55 16.878 16.335 18.5745 14.634 18.8065C12.3525 19.14 10.4355 16.994 10.854 14.529C11.124 12.934 12.447 11.7015 13.959 11.6C14.8095 11.542 15.579 11.832 16.2 12.3395V5.8C16.2 5.0025 16.8075 4.35 17.55 4.35H20.25C20.9925 4.35 21.6 5.0025 21.6 5.8C21.6 6.5975 20.9925 7.25 20.25 7.25ZM1.35 5.8C0.6075 5.8 0 6.4525 0 7.25V26.1C0 27.695 1.215 29 2.7 29H20.25C20.9925 29 21.6 28.3475 21.6 27.55C21.6 26.7525 20.9925 26.1 20.25 26.1H4.05C3.3075 26.1 2.7 25.4475 2.7 24.65V7.25C2.7 6.4525 2.0925 5.8 1.35 5.8Z"
          fill="#81F0FF"
        />
      </svg>
    </div>
    <a href="/library" class="nav_text nav-btn">Library</a>
  </div>

  <div class="search">
    <div class="search_icon">
      <svg viewBox="0 0 27 29" fill="none" xmlns="http://www.w3.org/2000/svg">
        <g id="Frame" clip-path="url(#clip0_107_5)">
          <path
            id="Vector"
            d="M21.9375 11.7812C21.9375 14.3811 21.1518 16.7826 19.8281 18.7311L26.5043 25.9074C27.1635 26.6154 27.1635 27.7652 26.5043 28.4732C25.8451 29.1813 24.7746 29.1813 24.1154 28.4732L17.4393 21.2969C15.6252 22.7242 13.3893 23.5625 10.9688 23.5625C4.90957 23.5625 0 18.2893 0 11.7812C0 5.27324 4.90957 0 10.9688 0C17.0279 0 21.9375 5.27324 21.9375 11.7812ZM10.9688 19.9375C11.966 19.9375 12.9534 19.7265 13.8748 19.3166C14.7961 18.9068 15.6332 18.306 16.3383 17.5486C17.0435 16.7912 17.6028 15.8921 17.9845 14.9025C18.3661 13.9129 18.5625 12.8523 18.5625 11.7812C18.5625 10.7102 18.3661 9.64955 17.9845 8.65999C17.6028 7.67043 17.0435 6.77129 16.3383 6.01391C15.6332 5.25653 14.7961 4.65575 13.8748 4.24586C12.9534 3.83597 11.966 3.625 10.9688 3.625C9.97152 3.625 8.98406 3.83597 8.06275 4.24586C7.14143 4.65575 6.3043 5.25653 5.59916 6.01391C4.89401 6.77129 4.33466 7.67043 3.95304 8.65999C3.57142 9.64955 3.375 10.7102 3.375 11.7812C3.375 12.8523 3.57142 13.9129 3.95304 14.9025C4.33466 15.8921 4.89401 16.7912 5.59916 17.5486C6.3043 18.306 7.14143 18.9068 8.06275 19.3166C8.98406 19.7265 9.97152 19.9375 10.9688 19.9375Z"
            fill="#81F0FF"
          />
        </g>
        <defs>
          <clipPath id="clip0_107_5">
            <rect width="27" height="29" fill="white" />
          </clipPath>
        </defs>
      </svg>
    </div>
    <a href="/search" class="nav_text nav-btn">Search</a>
  </div>

  <div class="playlists">
    <div class="playlist_icon">
      <svg
        viewBox="0 0 27 29"
        fill="none"
        xmlns="http://www.w3.org/2000/svg%22%3E"
      >
        <g id="Group">
          <path
            id="Vector"
            d="M1.8 3.625H10.8C11.7941 3.625 12.6 2.81345 12.6 1.8125C12.6 0.811434 11.7941 0 10.8 0H1.8C0.805952 0 0 0.811434 0 1.8125C0 2.81345 0.805952 3.625 1.8 3.625Z"
            fill="#81F0FF"
          />
          <path
            id="Vector_2"
            d="M1.8 9.0625H10.8C11.7941 9.0625 12.6 8.25095 12.6 7.25C12.6 6.24893 11.7941 5.4375 10.8 5.4375H1.8C0.805952 5.4375 0 6.24893 0 7.25C0 8.25095 0.805952 9.0625 1.8 9.0625Z"
            fill="#81F0FF"
          />
          <path
            id="Vector_3"
            d="M12.6 12.6875C12.6 11.6864 11.7941 10.875 10.8 10.875H1.8C0.805952 10.875 0 11.6864 0 12.6875C0 13.6885 0.805952 14.5 1.8 14.5H10.8C11.7941 14.5 12.6 13.6885 12.6 12.6875Z"
            fill="#81F0FF"
          />
          <path
            id="Vector_4"
            d="M22.2373 4.29982C21.2087 3.50067 19.8001 2.40592 19.8001 1.8125C19.8001 0.811547 18.9941 0 18 0C17.006 0 16.2 0.811547 16.2 1.8125V18.4411C15.6363 18.24 15.0322 18.125 14.4 18.125C11.4177 18.125 9.00003 20.5594 9.00003 23.5625C9.00003 26.5656 11.4177 29 14.4 29C17.3824 29 19.8001 26.5656 19.8001 23.5625V6.98339C19.8796 7.04536 19.9587 7.10817 20.038 7.16991C22.0689 8.74746 23.4001 9.89308 23.4001 11.3786C23.4001 13.6876 22.1803 14.9762 22.1454 15.0129C21.4326 15.7107 21.4163 16.8581 22.1093 17.5759C22.4622 17.9414 22.9309 18.125 23.4002 18.125C23.8522 18.125 24.3048 17.9546 24.6547 17.6121C24.8949 17.3772 27 15.2058 27 11.3785C27.0001 8.00049 24.3592 5.94857 22.2373 4.29982Z"
            fill="#81F0FF"
          />
        </g>
      </svg>
    </div>
    <a href="/playlists" class="nav_text nav-btn">Playlists</a>
  </div>

  <div class="albums">
    <div class="album_icon">
      <svg viewBox="0 0 27 29" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          id="Vector"
          d="M25.65 0H6.75C6.39196 0 6.04858 0.152767 5.79541 0.424695C5.54223 0.696623 5.4 1.06544 5.4 1.45V2.9H1.35C0.991958 2.9 0.64858 3.05277 0.395406 3.3247C0.142232 3.59662 0 3.96544 0 4.35V24.65C0 25.0346 0.142232 25.4034 0.395406 25.6753C0.64858 25.9472 0.991958 26.1 1.35 26.1H5.4V27.55C5.4 27.9346 5.54223 28.3034 5.79541 28.5753C6.04858 28.8472 6.39196 29 6.75 29H25.65C26.008 29 26.3514 28.8472 26.6046 28.5753C26.8578 28.3034 27 27.9346 27 27.55V1.45C27 1.06544 26.8578 0.696623 26.6046 0.424695C26.3514 0.152767 26.008 0 25.65 0ZM2.7 23.2V5.8H5.4V23.2H2.7ZM24.3 26.1H8.1V2.9H24.3V26.1ZM16.2 23.0188C17.2741 23.0188 18.3043 22.5604 19.0638 21.7447C19.8233 20.9289 20.25 19.8224 20.25 18.6688V7.43125C20.25 7.04669 20.1078 6.67787 19.8546 6.40595C19.6014 6.13402 19.258 5.98125 18.9 5.98125C18.542 5.98125 18.1986 6.13402 17.9454 6.40595C17.6922 6.67787 17.55 7.04669 17.55 7.43125V14.5856C17.1177 14.4138 16.6609 14.3236 16.2 14.3188C15.1259 14.3188 14.0957 14.7771 13.3362 15.5928C12.5767 16.4086 12.15 17.5151 12.15 18.6688C12.15 19.8224 12.5767 20.9289 13.3362 21.7447C14.0957 22.5604 15.1259 23.0188 16.2 23.0188ZM16.2 17.2188C16.467 17.2188 16.728 17.3038 16.95 17.4631C17.172 17.6224 17.3451 17.8489 17.4472 18.1139C17.5494 18.3788 17.5762 18.6704 17.5241 18.9516C17.472 19.2329 17.3434 19.4913 17.1546 19.6941C16.9658 19.8968 16.7252 20.0349 16.4634 20.0909C16.2015 20.1468 15.9301 20.1181 15.6834 20.0084C15.4367 19.8986 15.2259 19.7128 15.0775 19.4743C14.9292 19.2359 14.85 18.9555 14.85 18.6688C14.85 18.2842 14.9922 17.9154 15.2454 17.6434C15.4986 17.3715 15.842 17.2188 16.2 17.2188Z"
          fill="#81F0FF"
        />
      </svg>
    </div>
    <a href="/albums" class="nav_text nav-btn">Albums</a>
  </div>

  <div class="profile">
    <div id="type-dark" class="refresh_icon">
      <svg
        fill="#81F0FF"
        version="1.1"
        id="Capa_1"
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        viewBox="0 0 489.533 489.533"
        xml:space="preserve"
      >
        <g>
          <path
            fill="#81F0FF"
            d="M268.175,488.161c98.2-11,176.9-89.5,188.1-187.7c14.7-128.4-85.1-237.7-210.2-239.1v-57.6c0-3.2-4-4.9-6.7-2.9
            l-118.6,87.1c-2,1.5-2,4.4,0,5.9l118.6,87.1c2.7,2,6.7,0.2,6.7-2.9v-57.5c87.9,1.4,158.3,76.2,152.3,165.6
            c-5.1,76.9-67.8,139.3-144.7,144.2c-81.5,5.2-150.8-53-163.2-130c-2.3-14.3-14.8-24.7-29.2-24.7c-17.9,0-31.9,15.9-29.1,33.6
            C49.575,418.961,150.875,501.261,268.175,488.161z"
          />
        </g>
      </svg>
    </div>
    <Avatar class="acs" src="/assets/pfp-placeholder.png" />
    <Dropdown triggeredBy=".acs">
      <DropdownItem class="text-black"
        ><a href="/settings">Settings</a></DropdownItem
      >
    </Dropdown>
  </div>
  <div id="nav-move"></div>
  <Tooltip
    {type}
    triggeredBy="[id^='type-']"
    on:show={(ev) => (type = ev.target.id.split('-')[1])}
    >Refresh Library</Tooltip
  >
</div>

<style>
</style>
